#!/bin/bash

echo -e "\033[38;5;208m
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⣿⣿⣶⣶⣦⣄⡀⠀⠀⠀⠀⢀⣀⣠⣤⣤⣴⣶⣶⣦⣤⣤⣄⣀⠀⠀⠀⠀⠀⣀⣤⣴⣶⣾⣿⣿⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣴⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣴⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⣀⣀⣀⠀⠀⠀⠀⠈⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠀⠀⠀⠀⠀⣀⣀⣀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠉⠉⠙⠛⠿⢿⣶⣦⣀⠀⣿⣿⣿⣿⣿⣿⡿⠋⠁⠀⠀⠉⠻⣿⣿⣿⣿⣿⣿⠛⠁⠀⠀⠈⠙⢿⣿⣿⣿⣿⣿⣏⠀⣠⣴⣾⡿⠟⠛⠋⠉⠁⠀⠀⠀⠀
⠀⢀⣠⣤⣤⣤⣤⣤⣤⣀⣈⠙⠻⣷⣿⣿⣿⣿⣿⡟⠀⠀⠀⢀⠀⠀⠀⠘⣿⣿⣿⣿⠁⠀⠀⠀⠀⠀⠀⠀⢿⣿⣿⣿⣿⣿⡿⠟⠋⣁⣀⣤⣤⣤⣤⣤⣤⣀⡀⠀
⠈⠉⠉⠉⠉⠉⠉⠉⠛⠛⠿⢿⣶⣄⣿⣿⣿⣿⣿⡇⠀⠀⠀⣾⡆⠀⠀⠀⣿⣿⣿⣿⠀⠀⠀⢸⣧⠀⠀⠀⣸⣿⣿⣿⣿⣿⣤⣶⡿⠟⠛⠋⠉⠉⠉⠉⠉⠉⠉⠁
⠀⠀⠀⣠⣤⣶⣶⣶⣶⣶⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣄⠀⠀⢿⠃⠀⢀⣼⣿⣿⣿⣿⣧⡀⠀⠸⡏⠀⠀⣠⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣶⣶⣶⣶⣶⣤⣄⠀⠀⠀
⠀⠀⠊⠉⠁⠀⣠⣶⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣤⣤⣶⣿⣿⣿⠿⠿⣿⣿⣿⣶⣤⣤⣴⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣦⣀⠀⠈⠉⠑⠀⠀
⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠛⠛⠛⠛⠛⠛⠛⠋⠀⠀⠀⠀⠙⠛⠛⠛⠛⠛⠛⠛⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡆⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠁ █▀ █ █▀█▀█ █▄▄ █▄▄ █▀█  ⠘⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠁⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠻⢿⣿⡿⠟⠉⠁⠀⠀⠀ ▄█ █ █░▀░█ █▄█ █▄█ █▀█⠀ ⠀ ⠀⠈⠉⠻⣿⣿⠿⠋⠉⠉⠉⠀⠀⠀⠀⠀⠀⠀ 
			  Author: AggressiveUser			   
      [SIMBBA - THE AI ChatBOT] Say \"BYE\" To Me For END Conversation.\033[0m"
      
API_KEY=$(cat /opt/simbba/access.key 2>/dev/null)

if [[ -z "$API_KEY" ]]; then
  echo "     "
  echo -e '     \e[31m(API KEY Is Not Present)\e[0m Configure API KEY Using Below Command !'
  echo -e '\e[32m     bash config.sh -T <API-KEY> \e[0m'
  exit 1
fi

RESPONSE=$(curl -s -X POST -H "Authorization: Bearer $API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"model": "davinci", "prompt": "Hello, world!", "temperature": 0.5}' \
  "https://api.openai.com/v1/completions")

if [[ "$RESPONSE" =~ "invalid_api_key" ]]; then
  echo "     "
  echo -e '     \e[31m(Invalid API KEY)\e[0m Configure secret API KEY Using Below Command !'
  echo -e '\e[32m     bash config.sh -T <API-KEY> \e[0m'
  exit 1
fi

# Fu*kin CHATBOT API
url="https://api.openai.com/v1/completions"
echo ""

# Indicator
message="			CHAT-BOT Server Is Live 🤖"
green='\033[0;32m'
NC='\033[0m' 

for (( i=0; i<${#message}; i++ )); do
  printf "${green}${message:$i:1}${NC}"
  sleep 0.1
done
echo ""

# CHAT WALL

while true; do
  read -p $'\033[0;34mAggressiveUser:\033[0m ' prompt
  
  if [ "$prompt" = "BYE" ]; then
    break
  fi
  
  data='{"model": "text-davinci-003", "prompt": "'"$prompt"'", "temperature": 1.0, "max_tokens": 4000}'

  response=$(curl -s -H "Content-Type: application/json" -H "Authorization: Bearer ${API_KEY}" -d "${data}" "${url}")

  text=$(echo "$response" | jq -r '.choices[].text')
  echo -e "\e[31mSimbba:\e[0m $text"
done
